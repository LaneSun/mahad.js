(e=>{const t={apply:(e,t,n)=>{const s=new MahadElem;return n.length&&s.attr("inner",n),s},get:(e,t)=>{const s=()=>{};return s.ename=t,s.attrs=[],new Proxy(s,n)}},n={apply:(e,t,n)=>{const s=new MahadElem(e.ename);n.length&&s.attr("inner",n);for(const[t,n]of e.attrs)s.attr(t,n);return s},get:(e,t)=>(...s)=>{const r=()=>{};return r.ename=e.ename,r.attrs=t.startsWith("$")?e.attrs.concat([[t.slice(1),s[0]]]):e.attrs.concat([[t,s]]),new Proxy(r,n)}};e.ME=new Proxy((()=>{}),t);const s=Symbol("mahad-elem"),r={text:e=>[t=>e.textContent=t],html:e=>[t=>e.innerHTML=t],class:e=>[t=>e.classList.add(t),t=>e.classList.remove(t)],show:e=>[t=>{e.hidden=!t,t?e.classList.remove("f-hide"):e.classList.add("f-hide")}],value:(e,t)=>(e.addEventListener("change",(()=>{t.val=e.value})),[t=>e.value=t]),input:(e,t)=>(e.addEventListener("input",(()=>{t.val=e.value})),[t=>e.value=t]),style:e=>{const t=[(n,s)=>{0===s?n.guard(e,...t):n instanceof Array?n.guard(e,(t=>e.style.setProperty(s,t))):e.style.setProperty(s,n)},(t,n)=>{0===n?t.unguard(e):(t instanceof Array&&t.unset_to(e),e.style.removeProperty(n))}];return t},on:e=>{const t=[(n,s)=>{0===s?n.guard(e,...t):n instanceof Array?n.guard(e,(t=>e.addEventListener(s,t))):e.addEventListener(s,n)},(t,n)=>{t instanceof Array?t.unguard(e):e.removeEventListener(n,t)}];return t},inner:e=>[(t,n)=>{const s=a(t);n===e.childNodes.length?e.append(s):e.insertBefore(s,e.childNodes[n])},(t,n)=>{e.childNodes[n]?.remove()}]},a=e=>{if(e instanceof MahadElem)return e.elem;if(e instanceof Node)return e;if(globalThis.jQuery&&e instanceof jQuery)return e[0];if(e instanceof Promise){const t=i();return e.then((e=>t.replaceWith(a(e)))),t}return"object"!=typeof e?new Text(e):void 0},i=()=>document.createElement("div");e.MahadElem=class e extends MahadObject{constructor(e="div"){super(),this.name=e,this.elem=document.createElement(this.name),this.elem[s]=this}attr(e,t=[]){if(e in this)return this[e];{const n=r[e];if(n)this.modify(e,t.guard(this,...n(this.elem,t)));else{const n=e.toLowerCase().replace(/(_\w)/g,(e=>e[1].toUpperCase()));this.modify(e,t.guard(this,(e=>this.elem.setAttribute(n,e))))}return t}}attach(t){if(this.remove(),"string"==typeof t)document.querySelector(t).append(this.elem);else if(t instanceof HTMLElement){const e=t[s];e?e.attr("inner").suffix(this):t.append(this.elem)}else if(t instanceof e)t.attr("inner").suffix(this);else{if(!(globalThis.jQuery&&t instanceof jQuery))throw"Unexpect attach target";t.append(this.elem)}return this}remove(e=null){if(e)this.attr("inner").delete_at(e);else{const e=this.elem.parentNode?.[s];e?e.remove(this):this.elem.remove()}}get rect(){return this.elem.getClientRects()[0]}focus(e){this.elem.focus(e)}focused(){return document.activeElement===this.elem}listen(e,t,n){this.elem.addEventListener(e,t,n)}select(){const e=window.getSelection();e.removeAllRanges(),e.selectAllChildren(this.elem)}}})(globalThis);